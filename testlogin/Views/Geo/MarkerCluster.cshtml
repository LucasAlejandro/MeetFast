@{
    ViewBag.Title = "markerCluster";
}
<style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
    #map {
        height: 400px;
        width: 100%;
    }
    /* Optional: Makes the sample page fill the window. */
    html, body {
        height: 100%;
        margin: 0;
        padding: 20px;
    }
</style>

<br />
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <div id="map"></div>
        </div>
        <div class="col-sm-3 form-group">
            <label>Radio busqueda :</label>

            <select id="zoom" class="form-control">
                <option value="16">x5</option>
                <option value="14">x4</option>
                <option value="8">x3</option>
                <option value="4">x2</option>
                <option value="2">x1</option>
            </select>

            <br />
            <input type="submit" class="btn " value="Buscar" onclick="zoomHasta(document.getElementById('zoom').value)" />

        </div>
    </div>
</div>

<script>
    window.onload = function () {
        initMap(16);
        console.log("funciona");
    };


    function zoomHasta(valor) {

        var valorEntero = parseInt(valor);

        initMap(valorEntero);
    };
    var locations = [
        { lat: 38.988266, lng: -1.861976 },
        { lat: 33.718234, lng: 1.363181 },
        { lat: 33.727111, lng: 2.371124 },
        { lat: 38.269932, lng: -0.712561 },
        { lat: 33.851702, lng: 4.216968 },
        { lat: 34.671264, lng: 5.863657 },
        { lat: 35.304724, lng: 6.662905 },
        { lat: 36.817685, lng: 7.699196 },
        { lat: 36.828611, lng: 8.790222 },
        { lat: 37.783642, lng: -3.783768 },
        { lat: 37.759859, lng: 10.128708 },
        { lat: 37.765015, lng: 11.133858 },
        { lat: 37.770104, lng: 12.143299 },
        { lat: 37.773700, lng: 13.145187 },
        { lat: 37.774785, lng: 14.137978 },
        { lat: 37.819616, lng: 15.968119 },
        { lat: 40.416775, lng: -3.703790 },
        { lat: 39.927193, lng: 17.053218 },
        { lat: 41.330162, lng: 18.865694 },
        { lat: 42.734358, lng: 19.439506 },
        { lat: 42.734358, lng: 20.501315 },
        { lat: 42.735258, lng: 23.438000 },
        { lat: 43.999792, lng: 25.463352 }
    ]


    // Lanza mapa sin zoom //
    //no necesaria/
    //lanza mapa con zoom//
    function initMap(zoom) {
        var infoWindow = new google.maps.InfoWindow;
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 0,
            center: { lat: -31.563910, lng: 147.154312 }
        });

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                var pos = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };
                infoWindow.setPosition(pos);
                infoWindow.setContent('Mi ubicacion');
                infoWindow.open(map);
                map.setCenter(pos);

                map.setZoom(map.getZoom() + zoom);

            });

        } else { console.log("Necesita activar ubicacion"); }


        // Create an array of alphabetical characters used to label the markers.
        var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

        // Add some markers to the map.
        // Note: The code uses the JavaScript Array.prototype.map() method to
        // create an array of markers based on a given "locations" array.
        // The map() method here has nothing to do with the Google Maps API.
        var markers = locations.map(function (location, i) {
            return new google.maps.Marker({
                position: location,
                label: labels[i % labels.length]
            });
        });

        // Add a marker clusterer to manage the markers.
        var markerCluster = new MarkerClusterer(map, markers,
            { imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m' });
    }

</script>
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyALkm0kVQkpCFu2G6KbXft7F9nAG120eYI"
        async defer></script>